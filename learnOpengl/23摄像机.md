# 摄像机数据类设计 
ViewMatrix：相机的旋转状态描述+位置状态描述
ProjectionMatrix：相机的投影参数描述
![输入图片说明](/imgs/2024-11-03/c9GmgJj20sfrGT4j.png)
用up代替top，也能计算出ViewMatrix
制作相机类的代码如下：
```
#pragma once
#include "../../glframework/core.h"

class Camera {
public:
	Camera();
	~Camera();

	glm::mat4 getViewMatrix();
	virtual glm::mat4 getProjectionMatrix();
public: 
	glm::vec3 mPosition{ 0.0f,0.0f,1.0f };
	glm::vec3 mUp{ 0.0f,1.0f,0.0f };
	glm::vec3 mRight{ 1.0f,0.0f,0.0f };
};
```
```
#include "camera.h"

Camera::Camera(){}
Camera::~Camera(){}
glm::mat4 Camera::getViewMatrix()
{
	//lookat:
	//eye:相机位置
	//center：看向世界坐标的哪个点
	//top：穹顶（使用mUp代替）
	glm::vec3 front = glm::cross(mUp, mRight);
	glm::vec3 center = mPosition + front;

	return glm::lookAt(mPosition, center, mUp);
}
glm::mat4 Camera::getProjectionMatrix()
{
	return glm::identity<glm::mat4>();
}
```
我们利用c++的多态来建立相机
![输入图片说明](/imgs/2024-11-04/kJ1EvVSMMmQiMzQk.png)
OrthographicCamera类：
```
#pragma once
#include "camera.h"

class OrthographicCamera :public Camera {
public:
	OrthographicCamera(float l, float r, float t, float b, float n, float f);
	~OrthographicCamera();
	glm::mat4 getProjectionMatrix() override;
private:
	float mLeft = 0.0f;
	float mRight = 0.0f;
	float mTop = 0.0f;
	float mBottom = 0.0f;
	float mNear = 0.0f;
	float mFar = 0.0f;
};
```
```
#include "orthographicCamera.h"
OrthographicCamera::OrthographicCamera(float l, float r, float t, float b, float n, float f)
{
	mLeft = l;
	mRight = r;
	mTop = t;
	mBottom = b;
	mNear = n;
	mFar = f;
}
OrthographicCamera::~OrthographicCamera(){}

glm::mat4 OrthographicCamera::getProjectionMatrix()
{
	return glm::ortho(mLeft, mRight, mTop, mBottom, mNear, mFar);
}
```
PerspectiveCamera类：
```
#pragma once
#include "camera.h"
class PerspectiveCamera :public Camera {
public:
	PerspectiveCamera(float fovy, float aspect, float near, float far);
	~PerspectiveCamera();

	glm::mat4 getProjectionMatrix() override;
private:
	float mFovy = 0.0f;
	float mAspect = 0.0f;
	float mNear = 0.0f;
	float mFar = 0.0f;
};
```
```
#include "perspectiveCamera.h"
PerspectiveCamera::PerspectiveCamera(float fovy, float aspect, float near, float far)
{
	mFovy = fovy;
	mAspect = aspect;
	mNear = near;
	mFar = far;
}
PerspectiveCamera::~PerspectiveCamera(){}

glm::mat4 PerspectiveCamera::getProjectionMatrix()
{
	return glm::perspective(glm::radians(mFovy), mAspect, mNear, mFar);
}

```
# 摄像机控制类设计
左边为游戏相机，右边为建模相机
![输入图片说明](/imgs/2024-11-04/WUNG9aOzIYFYsJeO.png)
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTA1MTM3ODc5MSwyNjI5Mjc0MDAsMjAxNz
Q4Mzc3LC00MTMwNjc4NzQsLTEyMTMzOTMyMDQsMTIyNTA1NDU1
M119
-->