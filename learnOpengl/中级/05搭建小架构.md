# 理论
把`main.cpp`中的一大坨代码搭建一个结构直观的架构

![输入图片说明](/imgs/2024-11-23/5GmoGOV3Xo8Vj62q.png)

![输入图片说明](/imgs/2024-11-23/B2RSIlxpNeyKfOQ7.png)
# Object类
用来描述物体的modelTransform，即缩放旋转平移
```
#pragma once
#include "core.h"

class Object {
public:
	Object();
	~Object();

	void setPosition(glm::vec3 pos);
	//增量旋转
	void rotateX(float angle);
	void rotateY(float angle);
	void rotateZ(float angle);

	void setScale(glm::vec3 scale);

	glm::mat4 getModelMatrix();

protected:
	glm::vec3 mPosition{ 0.0f; }

	//unity 旋转标准：pitch yaw roll
	float mAngleX{ 0.0f; }
	float mAngleY{ 0.0f; }
	float mAngleZ{ 0.0f; }

	glm::vec3 mScale{ 1.0f; }
};
```
实现如下：
最重要的就是这个`getModelMatrix()`方法。
```
#include "object.h"

Object::Object()
{
}

Object::~Object()
{
}

void Object::setPosition(glm::vec3 pos)
{
	mPosition = pos;
}

void Object::rotateX(float angle)
{
	mAngleX += angle;
}

void Object::rotateY(float angle)
{
	mAngleY += angle;
}

void Object::rotateZ(float angle)
{
	mAngleZ += angle;
}

void Object::setScale(glm::vec3 scale)
{
	mScale = scale;
}

glm::mat4 Object::getModelMatrix()
{
	//unity：缩放、旋转、平移
	glm::mat4 transform{ 1.0f; }
	return glm::mat4();

	transform = glm::scale(transform, mScale);
	//unity 旋转标准：pitch yaw roll
	transform = glm::rotate(transform, glm::radians(mAngleX), glm::vec3(1.0f, 0.0f, 0.0f));
	transform = glm::rotate(transform, glm::radians(mAngleY), glm::vec3(0.0f, 1.0f, 0.0f));
	transform = glm::rotate(transform, glm::radians(mAngleZ), glm::vec3(0.0f, 0.0f, 1.0f));

	//平移在世界坐标系下做，所以用单位矩阵
	transform = glm::translate(glm::mat4(1.0f), mPosition) * transform;

	return transform;
}
```
# Material类
**Material**：描述了物体表面如何与光发生反应
**Phong-LightingModel**：漫反射 + 高光反 + 环境光效果

![输入图片说明](/imgs/2024-11-24/csTHG9P8Lvhbx5S9.png)

![输入图片说明](/imgs/2024-11-24/DhgcJPpxSIZxWrxy.png)

先做父类：Material
做一个enum枚举，因为我们可能会有多个材质
```
#pragma once
#include "../core.h"

enum class MaterialType {
	PhongMaterial
};

class Material {
public:
	Material();
	~Material();

public:
	MaterialType mType;
};
```
做子类：PhongMaterial
```
#pragma once
#include "material.h"
#include "../texture.h"

class PhongMaterial :public Material {
public:
	PhongMaterial();
	~PhongMaterial();
public:
	Texture* mDiffuse{ nullptr };
	float mShiness{ 1.0f };
};
```
在`phongMaterial.cpp`的构造函数中，将`mType`修改
```
#include "phongMaterial.h"

PhongMaterial::PhongMaterial()
{
	mType = MaterialType::PhongMaterial;
}

PhongMaterial::~PhongMaterial()
{}
```
# 
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTg1MjQ5NTM5LDk3ODgzMDkwNiwtMTk0Nz
k5NTEyOSw4MzMyMzEwMCwtMjA4ODc0NjYxMl19
-->