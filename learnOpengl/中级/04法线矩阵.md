# 引入问题
球旋转时光斑不会随着球旋转而变化

![输入图片说明](/imgs/2024-11-23/AnNMDU5afZipWxS0.png)

旋转和平移可行，缩放不可行。
如右图所示，x方向缩小，y轴不变的话，发现并不能保持垂直于斜面

![输入图片说明](/imgs/2024-11-23/k3yAxraRymoi7j8b.png)

切线`T`符合`ModelMatrix`的变换，所以我们求出`T'`，根据`T'`和`N'`的正交相乘为0求出`N'`

![输入图片说明](/imgs/2024-11-23/tMyqIWxrgH9xqc53.png)

![输入图片说明](/imgs/2024-11-23/6WU1rjBjvMgYDC1B.png)

![输入图片说明](/imgs/2024-11-23/bMcOIsmOHnTWB0uS.png)

# 代码实现
也很easy，只要去`vertexShader`中对法线做变换就行，把正确的法线往后传
先用`mat3`把`modelMatrix`从四维变成三维，因为`normal`是三维向量
`inverse`用来求逆矩阵
`transpose`用来求转置
```
void main()
{
    normal = transpose((inverse(mat3(modelMatrix)))) * aNormal;
}
```


<!--stackedit_data:
eyJoaXN0b3J5IjpbMTUxODYwMjc3OSwtNzUxMDkzNTY5LC0xOT
QwNzA2MjYyLDI3MDg3Mzk1Ml19
-->