# 理论

![输入图片说明](/imgs/2024-11-26/2dfpIGj5J1xnSsOp.png)

![输入图片说明](/imgs/2024-11-26/dHcTLRBK47oaLLKe.png)

![输入图片说明](/imgs/2024-11-26/CZ1U4Vk9RK3qmrLR.png)

经验参数：


![输入图片说明](/imgs/2024-11-26/ICANMfJeesDcFN9t.png)

# 实现
目标：
1. 加入新的材质（纯白色）表示灯泡光源（之前只有phongMaterial）
2. 加入`whiteShader`（之前的`phong`模型肯定不适合搞这个），用于白色材质渲染
3. 在`Render`函数中加入白色材质的解析与渲染（之前的`switch`分支中只有`phong`的）
4. 加入`PointLight`类

### 目标一
在`material.h`中，添加一个新的枚举`WhiteMaterial`
```
enum class MaterialType {
	PhongMaterial,
	WhiteMaterial
};
};
```
然后创建两个文件`whiteMaterial.h`和`whiteMaterial.cpp`，并创建构造函数
cpp实现如下：
```
#include "whiteMaterial.h"

WhiteMaterial::WhiteMaterial()
{
	mType = MaterialType::WhiteMaterial;
}

WhiteMaterial::~WhiteMaterial()
{}
```
### 目标二
创建`white.vert`
```
#version 460 core
layout (location = 0) in vec3 aPos;
layout (location = 1) in vec2 aUV;
layout (location = 2) in vec3 aNormal;

out vec2 uv;
out vec3 normal;

uniform mat4 modelMatrix;
uniform mat4 viewMatrix;
uniform mat4 projectionMatrix;

void main()
{
    vec4 transformPosition = vec4(aPos, 1.0);
    transformPosition = modelMatrix * transformPosition;
    gl_Position = projectionMatrix * viewMatrix * transformPosition;
    uv = aUV;
}
```
创建`white.frag`
```
#version 460 core
out vec4 FragColor;

uniform float time;
in vec2 uv;
in vec3 normal;
void main()
{
	FragColor = vec4(vec3(1.0, 1.0, 1.0), 1.0);
}
```
### 目标三
去到`render.h`中声明一个白色的`shader`对象
```
private:
	//生成多种不同的shader对象
	//根据材质类型的不同，挑选使用哪一个shader对象
	Shader* mPhongShader{ nullptr };
	Shader* mWhiteShader{ nullptr };
```
在`render.cpp`中的构造函数进行`mWhiteShader`的初始化
```
Renderer::Renderer()
{
	mPhongShader = new Shader("assets/shaders/phong.vert", "assets/shaders/phong.frag");
	mWhiteShader = new Shader("assets/shaders/white.vert", "assets/shaders/white.frag");
}
```
完善`pickShader`函数，添加`WhiteMaterial`的情况
```
Shader* Renderer::pickShader(MaterialType type)
{
	Shader* result = nullptr;
	switch (type) {
	case MaterialType::PhongMaterial:
		result = mPhongShader;
		break;
	case MaterialType::WhiteMaterial:
		result = mWhiteShader;
		break;
	default:
		std::cout << "Unknown material type to pick shader" << std::endl;
		break;
	}
	return result;
}
```

<!--stackedit_data:
eyJoaXN0b3J5IjpbLTc5Njk2MjIyMiwxNjM0NzExMiwtMTczND
c1MTI0MywtMjAxNjc5NDU3MiwtMTM4ODkxNzE4Ml19
-->