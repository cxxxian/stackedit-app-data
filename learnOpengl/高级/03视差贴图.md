# parallaxMap（视差贴图）

![输入图片说明](/imgs/2025-02-23/rPsFTtKYeXrFpMXZ.png)

![输入图片说明](/imgs/2025-02-23/3VpPJngGTiqt4g2n.png)

![输入图片说明](/imgs/2025-02-23/0wWkfQm80XqQbtiH.png)

![输入图片说明](/imgs/2025-02-23/Xv2898RFWuo9cSNO.png)

意思就是，我们看向`A`点，如果表面的高度正确的话，应该看到的是`B`的颜色，而不是被`A`挡住

![输入图片说明](/imgs/2025-02-23/cCgN4I48Utz9goKC.png)

这里就是把：
在世界坐标系下的`viewDir`转换到`uv`坐标系下，通过乘上`TBN`的逆矩阵即可以转化

![输入图片说明](/imgs/2025-02-23/Hn6lVqclPSR99ftD.png)

但是我们在`vertexShader`中计算逆矩阵其实是很耗费性能的，此时我们可以注意到`TBN`其实是正交矩阵，只需转置即可得到逆矩阵

![输入图片说明](/imgs/2025-02-23/FjpBv3Qqk5MwoqY6.png)

采样`ParallaxMap`的值，深度值越大，说明偏移量越大，深度值为`0`，就代表无需偏移

举例，上面需要偏移长度`uv2`，下面偏移长度`uv1`
所以可以得出深度越大，偏移越多

![输入图片说明](/imgs/2025-02-23/UlaObhQLnXy4WOka.png)

<!--stackedit_data:
eyJoaXN0b3J5IjpbMTUwMzEzNzc1NiwxMjg2MzExMjgxLDIzNz
Y4MjA1NiwtMTM4Mjc5ODcxMSwtMTMwMjc5NTg2NiwtMjA5NDk5
NjA2MF19
-->