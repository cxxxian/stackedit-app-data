# unique_ptr

## move
### 一、unique_ptr 的移动语义背景

`unique_ptr` 是**独占资源所有权**的智能指针，因此它：

-   禁止拷贝（不能有两个 `unique_ptr` 管理同一个指针）
    
-   只允许**移动**来转移所有权
    

----------

### 二、`std::move` 的作用（转移所有权）

cpp

复制编辑

`std::unique_ptr<int> p1(new int(10)); std::unique_ptr<int> p2 = std::move(p1);`

含义如下：

-   `std::move(p1)` **将 p1 变为右值**，允许调用移动构造函数
    
-   所有权从 `p1` 转移到 `p2`，`p1` 变为空指针
    

等价于：

cpp

复制编辑

`// 内部是调用了 unique_ptr 的移动构造函数 p2 = unique_ptr<int>(std::move(p1));  // 实际是构造了一个临时对象并赋值`

移动后：

-   `p1.get() == nullptr`
    
-   `p2.get()` 指向原来的资源
    

**注意：`std::move()` 不移动任何东西，只是让变量变成“右值”，允许移动。**
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTQ2MzE0Nzk5M119
-->